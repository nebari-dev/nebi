# Development overrides for local k3d environment
# These values override the defaults in values.yaml

## Deployment configuration for development
deployment:
  api:
    replicas: 1  # Just 1 API pod for dev
    resources:
      requests:
        memory: 128Mi
        cpu: 50m
      limits:
        memory: 512Mi
        cpu: 500m
  worker:
    replicas: 1  # Just 1 worker pod for dev
    resources:
      requests:
        memory: 256Mi
        cpu: 100m
      limits:
        memory: 1Gi
        cpu: 500m

## Image configuration for local development
image:
  pullPolicy: Never  # Use locally built images, don't pull from registry
  tag: "latest"

## Service configuration for local access
service:
  type: NodePort
  nodePort: 30080  # Fixed port for consistent local access

## Resource limits - relaxed for local dev
## Increased memory to support pixi installing real packages (numpy, pandas, etc.)
resources:
  requests:
    memory: "128Mi"
    cpu: "50m"
  limits:
    memory: "1Gi"
    cpu: "500m"

## Persistence - use k3s local-path for dev
persistence:
  data:
    storageClass: "local-path"
    accessMode: ReadWriteOnce
    size: 2Gi

  environments:
    storageClass: "local-path"
    accessMode: ReadWriteOnce  # local-path only supports RWO; works in k3d single-node cluster
    size: 10Gi

## Application configuration for development
config:
  ginMode: debug
  logLevel: debug
  logFormat: text

## Default admin user (created on first startup if no users exist)
admin:
  username: "admin"
  password: "admin123"
  email: "admin@nebi.local"

## Health probes - faster for development
livenessProbe:
  initialDelaySeconds: 5
  periodSeconds: 15

readinessProbe:
  initialDelaySeconds: 3
  periodSeconds: 5

## Database configuration - PostgreSQL for development (required for separate workers)
database:
  driver: postgres
  dsn: ""  # Will be auto-constructed from postgres settings
  maxIdleConns: 5
  maxOpenConns: 10
  connMaxLifetime: 30

## Queue configuration - Valkey for development (required for separate workers)
queue:
  type: valkey
  valkeyAddr: ""  # Will be auto-constructed from valkey settings

## PostgreSQL - enabled for development (required for separate workers)
postgres:
  enabled: true
  password: "dev-password-123"
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "512Mi"
      cpu: "500m"

## Valkey - enabled for development (required for separate workers)
valkey:
  enabled: true
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "250m"
